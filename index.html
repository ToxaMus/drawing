<html>

<head>
    <link href="main.css" rel="stylesheet">
    <script src="Figurs.js"></script>
</head>

<body>
    <div style="margin: 10px;">
        <canvas id="lineY" width="40" height="800"></canvas>
        <canvas id="canvas" width="800" height="800"></canvas>
    </div>

    <canvas id="lineX" width="800" height="33" style="margin-bottom: 1em"></canvas>

    <div> Геометрическая фигура:
        <select id="geometryType">
            <option value="line">Линия</option>
            <option value="triangle">Треугольник</option>
            <option value="rectangle">Прямоугольник</option>
            <option value="circle">круг</option>
        </select>
    </div>

    <div>
        <div id="message"> Задайте координату точки:</div>
        <input type="text" id="coordinateInput">
    </div>
</body>

<script>

    const canvas = document.getElementById("canvas");
    const context = canvas.getContext("2d");

    let canvasWidth = 800;
    let canvasHeight = 800;

    coordinateTable(canvasWidth, canvasHeight, context)
    rulerY();
    rulerX();

    const geometryTypeElement = document.getElementById("geometryType");

    let geometryType;
    let polygon = [];
    let num = 0;

    geometryTypeElement.addEventListener('change', (event) => {
        geometryType = geometryTypeElement.value;
        num = 0;
        polygon = [];
        document.getElementById("message").innerHTML = "Задайте координату точки:"
    })

    let coord;
    let radius;

    const inputElement = document.getElementById("coordinateInput");

    inputElement.addEventListener('keyup', (event) => {
        if (clickOnEnter(event)) {
            coord = stringToCoordinate(inputElement.value);

            if (geometryType === 'line' || geometryType === undefined) {
                if (!errorCoordinate(coord)) {
                    polygon.push({ x: coord[0], y: coord[1] });
                    drawLine(polygon, context);
                }
            }

            if (geometryType === 'triangle') {
                if (!errorCoordinate(coord)) {
                    polygon.push({ x: coord[0], y: coord[1] })
                    document.getElementById("message").innerHTML = "Задайте следущую координату через ';'" 
                }
                
                if (polygon.length === 3) {
                    drawTriangle(polygon, context);
                    polygon = []
                    document.getElementById("message").innerHTML = "Задайте координату точки:"
               }
            }

            if (geometryType === 'rectangle') {
                if (polygon.length < 2) {
                    if (!errorCoordinate(coord)) {
                        polygon.push({ x: coord[0], y: coord[1] })
                        document.getElementById("message").innerHTML = "Задайте накрестлежащую координату"
                    }

                    if (polygon.length == 2) {
                        drawReactangle(polygon, context)
                        polygon = [];
                        document.getElementById("message").innerHTML = "Задайте координату точки:"
                    }
                }
            }

            if (geometryType === 'circle') {
                if (polygon.length < 1) {
                    if (!errorCoordinate(coord)) {
                        polygon.push({ x: coord[0], y: coord[1] })
                        document.getElementById("message").innerHTML = "Задайте радиус"
                    }
                }

                if (num == 1 && !errorNigativeData(coord[0])) {
                    radius = coord[0];
                    drawCircle(polygon, radius, context)

                    polygon = [];
                    num = 0;
                    document.getElementById("message").innerHTML = "Задайте координату точки:"
                }

                if (polygon.length == 1) {
                    num = 1;
                }
            }
            inputElement.value = ''
        }
    })

</script>

</html>